"use strict";var J=Object.defineProperty;var o=(e,t)=>J(e,"name",{value:t,configurable:!0});var I=require("./get-pipe-path-BoR10qr8.cjs"),d=require("node:module"),p=require("node:path"),w=require("node:url"),y=require("get-tsconfig"),Q=require("node:fs"),b=require("./index-CoHsQGpm.cjs"),M=require("./client-D6NvIMSC.cjs");const k=[".js",".json",".ts",".tsx",".jsx"],g=Object.create(null);g[".js"]=[".ts",".tsx",".js",".jsx"],g[".jsx"]=[".tsx",".ts",".jsx",".js"],g[".cjs"]=[".cts"],g[".mjs"]=[".mts"];const S=o((e,t)=>{const s=e.split("?");let[n]=s;const r=p.extname(n);let a=g[r];if(a)n=n.slice(0,-r.length);else{if(!t)return;a=k}return a.map(c=>n+c+(s[1]?`?${s[1]}`:""))},"mapTsExtensions"),B=o(e=>{const t=e.indexOf(":");if(t!==-1)return e.slice(0,t)},"getScheme"),T=o(e=>e[0]==="."&&(e[1]==="/"||e[1]==="."||e[2]==="/"),"isRelativePath"),z=o(e=>T(e)||p.isAbsolute(e),"isUnixPath"),G=o(e=>{if(z(e))return!0;const t=B(e);return t&&t!=="node"},"requestAcceptsQuery"),R="file://",U=/\.([cm]?ts|[tj]sx)($|\?)/,H=/\.json($|\?)/,X=/\/(?:$|\?)/,L=/^(?:@[^/]+\/)?[^/\\]+$/;exports.fileMatcher=void 0,exports.tsconfigPathsMatcher=void 0,exports.allowJs=!1;const D=o(e=>{let t=null;if(e){const s=p.resolve(e);t={path:s,config:y.parseTsconfig(s)}}else{try{t=y.getTsconfig()}catch{}if(!t)return}exports.fileMatcher=y.createFilesMatcher(t),exports.tsconfigPathsMatcher=y.createPathsMatcher(t),exports.allowJs=t?.config.compilerOptions?.allowJs??!1},"loadTsconfig"),E=o(e=>Array.from(e).length>0?`?${e.toString()}`:"","urlSearchParamsStringify"),$=[".ts",".tsx",".jsx"],A=o((e,...t)=>{for(const s of $){const n=t.slice();n[0]+=s;try{return e(...n)}catch{}}},"tryExtensions"),K=o(e=>(t,...s)=>{try{return e(t,...s)}catch(n){const r=n;if(r.code==="MODULE_NOT_FOUND"&&!L.test(t)){const a=A(e,t,...s)||A(e,`${t}${p.sep}index`,...s);if(a)return a}throw r}},"createImplicitResolver"),V=`${p.sep}node_modules${p.sep}`,F=o(e=>{if(!e.startsWith("data:text/javascript,"))return;const t=e.indexOf("?");if(t===-1)return;const n=new URLSearchParams(e.slice(t+1)).get("filePath");if(n)return n},"getOriginalFilePath"),N=o(e=>{const t=F(e);return t&&(d._cache[t]=d._cache[e],delete d._cache[e],e=t),e},"interopCjsExports"),j=o((e,t,s)=>{if(!(s?.filename&&U.test(s.filename))&&!exports.allowJs)return;const n=S(t);if(n)for(const r of n)try{return e(r)}catch(a){const{code:c}=a;if(c!=="MODULE_NOT_FOUND"&&c!=="ERR_PACKAGE_PATH_NOT_EXPORTED")throw a}},"resolveTsFilename"),Y=o((e,t,s)=>{if(e.startsWith(R)&&(e=w.fileURLToPath(e)),exports.tsconfigPathsMatcher&&!T(e)&&!t?.filename?.includes(V)){const r=exports.tsconfigPathsMatcher(e);for(const a of r){const c=j(s,a,t);if(c)return c;try{return s(a)}catch{}}}const n=j(s,e,t);if(n)return n;try{return s(e)}catch(r){const a=r;if(a.code==="MODULE_NOT_FOUND"&&typeof a.path=="string"&&a.path.endsWith(`${p.sep}package.json`)){const c=a.message.match(/^Cannot find module '([^']+)'$/);if(c){const h=c[1],l=j(s,h,t);if(l)return l}const i=a.message.match(/^Cannot find module '([^']+)'. Please verify that the package.json has a valid "main" entry$/);if(i){const h=i[1],l=j(s,h,t);if(l)return l}}throw a}},"resolveRequest"),Z=o((e,t)=>(s,n,r,a)=>{const c=o(m=>e(m,n,r,a),"resolve");if(s=N(s),n?.filename){const m=F(n.filename);m&&(n.filename=m.split("?")[0])}const i=s.split("?"),h=new URLSearchParams(i[1]);if(n?.filename){const P=new URLSearchParams(n.filename.split("?")[1]).get("namespace");P&&h.append("namespace",P)}if((h.get("namespace")??void 0)!==t)return c(s);t&&(e=K(e));let l=Y(i[0],n,c);return p.isAbsolute(l)&&!l.endsWith(".json")&&!l.endsWith(".node")&&(l+=E(h)),l},"createResolveFilename"),q=`
//# sourceMappingURL=data:application/json;base64,`,W=o(()=>process.sourceMapsEnabled??!0,"shouldApplySourceMap"),v=o(({code:e,map:t})=>e+q+Buffer.from(JSON.stringify(t),"utf8").toString("base64"),"inlineSourceMap"),ee=[".cts",".mts",".ts",".tsx",".jsx"],te=[".js",".cjs",".mjs"],se=o(e=>{const t=Object.create(Object.getPrototypeOf(e)),s=Object.getOwnPropertyDescriptors(e);for(const n in s)Object.hasOwn(s,n)&&Object.defineProperty(t,n,s[n]);return t},"cloneExtensions"),O=o((e,t,s,n)=>{const r=Object.getOwnPropertyDescriptor(e,t);r?.set?e[t]=s:(!r||r.configurable)&&Object.defineProperty(e,t,{value:s,enumerable:r?.enumerable||n?.enumerable,writable:n?.writable??(r?r.writable:!0),configurable:n?.configurable??(r?r.configurable:!0)})},"safeSet"),ne=o((e,t)=>{const s=se(e),n=s[".js"],r=o((a,c)=>{const[i,h]=c.split("?");if((new URLSearchParams(h).get("namespace")??void 0)!==t)return n(a,i);M.parent?.send&&M.parent.send({type:"dependency",path:i});const m=ee.some(f=>i.endsWith(f)),P=te.some(f=>i.endsWith(f));if(!m&&!P)return n(a,i);let u=Q.readFileSync(i,"utf8");if(i.endsWith(".cjs")){const f=b.transformDynamicImport(c,u);f&&(u=W()?v(f):f.code)}else if(m||b.isESM(u)){const f=b.transformSync(u,c,{tsconfigRaw:exports.fileMatcher?.(i)});u=W()?v(f):f.code}a._compile(u,i)},"transformer");O(s,".js",r);for(const a of $)O(s,a,r,{enumerable:!t,writable:!0,configurable:!0});return O(s,".mjs",r,{writable:!0,configurable:!0}),s},"createExtensions"),C=o((e,t)=>{if(!t)throw new Error("The current file path (__filename or import.meta.url) must be provided in the second argument of tsx.require()");return(typeof t=="string"&&t.startsWith("file://")||t instanceof URL)&&(t=w.fileURLToPath(t)),p.resolve(p.dirname(t),e)},"resolveContext"),re=o(e=>{const{sourceMapsEnabled:t}=process,{_extensions:s,_resolveFilename:n}=d;D(process.env.TSX_TSCONFIG_PATH),process.setSourceMapsEnabled(!0);const r=Z(n,e?.namespace);d._resolveFilename=r;const a=ne(d._extensions,e?.namespace);d._extensions=a;const c=o(()=>{t===!1&&process.setSourceMapsEnabled(!1),d._extensions=s,d._resolveFilename=n},"unregister");if(e?.namespace){const i=o((l,m)=>{const P=C(l,m),[u,f]=P.split("?"),x=new URLSearchParams(f);return e.namespace&&x.set("namespace",e.namespace),I.require(u+E(x))},"scopedRequire");c.require=i;const h=o((l,m,P)=>{const u=C(l,m),[f,x]=u.split("?"),_=new URLSearchParams(x);return e.namespace&&_.set("namespace",e.namespace),r(f+E(_),module,!1,P)},"scopedResolve");c.resolve=h,c.unregister=c}return c},"register");exports.fileUrlPrefix=R,exports.inlineSourceMap=v,exports.interopCjsExports=N,exports.isBarePackageNamePattern=L,exports.isDirectoryPattern=X,exports.isJsonPattern=H,exports.loadTsconfig=D,exports.mapTsExtensions=S,exports.register=re,exports.requestAcceptsQuery=G,exports.tsExtensionsPattern=U;
